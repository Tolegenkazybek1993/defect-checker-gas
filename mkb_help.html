<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ –ú–ö–ë-10</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 15px;
      background: #f9f9f9;
      color: #212529;
    }
    h2 {
      color: #004080;
      margin-bottom: 12px;
    }
    input[type="text"], button {
      width: 100%;
      padding: 10px;
      margin-bottom: 12px;
      font-size: 15px;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    button {
      background-color: #004080;
      color: white;
      font-weight: bold;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #002855;
    }
    .result {
      margin-top: 15px;
      padding: 12px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      font-size: 14px;
      line-height: 1.4;
      color: #333;
    }
    .section {
      border-left: 5px solid #004080;
      background: #e7f0fd;
      margin-bottom: 12px;
      padding: 10px 15px;
      border-radius: 5px;
    }
    .warning {
      border-left-color: #dc3545;
      background: #f8d7da;
      color: #842029;
    }
    .info {
      border-left-color: #0d6efd;
      background: #cfe2ff;
      color: #084298;
    }
    .accent {
      border-left-color: #ffc107;
      background: #fff3cd;
      color: #664d03;
    }
  </style>
</head>
<body>
  <h2>üîç –ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø–æ –ú–ö–ë-10</h2>
  <input type="text" id="mkbInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ú–ö–ë-10, –Ω–∞–ø—Ä–∏–º–µ—Ä J45" />
  <button onclick="–ø–æ–ª—É—á–∏—Ç—å–ü–æ–¥—Å–∫–∞–∑–∫—É()">–ù–∞–π—Ç–∏</button>

  <div id="result" class="result" style="display:none;"></div>

  <script>
    function –ø–æ–ª—É—á–∏—Ç—å–ü–æ–¥—Å–∫–∞–∑–∫—É() {
      const –∫–æ–¥ = document.getElementById('mkbInput').value.trim().toUpperCase();
      const resultDiv = document.getElementById('result');
      resultDiv.style.display = 'block';
      resultDiv.innerHTML = '‚è≥ –ò–¥—ë—Ç –ø–æ–∏—Å–∫...';

      if (!–∫–æ–¥) {
        resultDiv.innerHTML = '<b>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥–∏–∞–≥–Ω–æ–∑–∞.</b>';
        return;
      }

      google.script.run.withSuccessHandler(function(res) {
        if (!res || res.length === 0) {
          resultDiv.innerHTML = '<div class="warning"><b>‚ùå –ö–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Ç–∞–±–ª–∏—Ü–µ "–ü—Ä–∞–≤–∏–ª–∞".</b></div>';
          return;
        }

        // –°–æ–±–∏—Ä–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –ø–æ –ø–æ–≤–æ–¥–∞–º –∏ –æ–ø–ª–∞—Ç–∞–º
        const —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ = new Set();
        const –±–ª–æ–∫–∏ = [];
        let –æ—Å—Ç—Ä–æ–µ–ì–û–ë–ú–ü = false;
        let –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ–û–°–ú–° = false;

        res.forEach(row => {
          const –ø–æ–≤–æ–¥ = row[0] || '';
          const –æ–ø–ª–∞—Ç–∞ = row[1] || '';
          const –∫–ª—é—á = –ø–æ–≤–æ–¥ + '|' + –æ–ø–ª–∞—Ç–∞;
          if (!—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ.has(–∫–ª—é—á)) {
            —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ.add(–∫–ª—é—á);
            –±–ª–æ–∫–∏.push(`–ü–æ–≤–æ–¥ –æ–±—Ä–∞—â–µ–Ω–∏—è: <b>${–ø–æ–≤–æ–¥}</b><br>–¢–∏–ø –æ–ø–ª–∞—Ç—ã: <b>${–æ–ø–ª–∞—Ç–∞}</b>`);
          }
          if (–ø–æ–≤–æ–¥.toLowerCase().includes("–æ–±–æ—Å—Ç—Ä–µ–Ω–∏–µ") && –æ–ø–ª–∞—Ç–∞.toLowerCase() === "–≥–æ–±–º–ø") –æ—Å—Ç—Ä–æ–µ–ì–û–ë–ú–ü = true;
          if (–ø–æ–≤–æ–¥.toLowerCase().includes("—Å–æ—Ü–∏–∞–ª—å–Ω–æ") && –æ–ø–ª–∞—Ç–∞.toLowerCase() === "–æ—Å–º—Å") –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ–û–°–ú–° = true;
        });

        let html = `<div class="section info"><b>üìå –ò–∑ —Ç–∞–±–ª–∏—Ü—ã "–ü—Ä–∞–≤–∏–ª–∞":</b><br>${–±–ª–æ–∫–∏.join('<br><br>')}</div>`;

        if (–æ—Å—Ç—Ä–æ–µ–ì–û–ë–ú–ü) {
          html += `
          <div class="section warning">
            ‚ö†Ô∏è <b>–í–Ω–∏–º–∞–Ω–∏–µ:</b><br>
            –ü—Ä–∏ –ø–æ–≤–æ–¥–µ –æ–±—Ä–∞—â–µ–Ω–∏—è <b>"–û—Å—Ç—Ä–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ (—Å–æ—Å—Ç–æ—è–Ω–∏–µ)/–û–±–æ—Å—Ç—Ä–µ–Ω–∏–µ —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è"</b> —Å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è <b>–ì–û–ë–ú–ü</b> –¥–∏–∞–≥–Ω–æ–∑ –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥–∏—Å–ø–∞–Ω—Å–µ—Ä–Ω–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è (–ø—Ä–∏–∫–∞–∑ ‚Ññ149 –ú–ó –†–ö).<br><br>
            üí° <b>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:</b><br>
            üìã –í–∑—è—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞ –Ω–∞ –¥–∏—Å–ø–∞–Ω—Å–µ—Ä–Ω—ã–π —É—á—ë—Ç.<br>
            ${–ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ–û–°–ú–° ? `‚úÖ –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–≤–æ–¥ –æ–±—Ä–∞—â–µ–Ω–∏—è <b>"–ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ —Å–æ—Ü–∏–∞–ª—å–Ω–æ-–∑–Ω–∞—á–∏–º–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ"</b> —Å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Ñ–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏—è <b>–û–°–ú–°</b>, –µ—Å–ª–∏ –ø–∞—Ü–∏–µ–Ω—Ç –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç –Ω–∞ –¥–∏—Å–ø–∞–Ω—Å–µ—Ä–Ω–æ–º —É—á—ë—Ç–µ.` : `‚úÖ –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º—ã –¥–∏–∞–≥–Ω–æ–∑–∞, –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å <b>–û–°–ú–°</b> –ø—Ä–∏ –¥–∞–Ω–Ω–æ–º –ø–æ–≤–æ–¥–µ.`}
          </div>`;
        }

        if (–∫–æ–¥.startsWith("Z34") || –∫–æ–¥ === "Z36") {
          html += `
          <div class="section warning">
            ‚ö†Ô∏è <b>–í–Ω–∏–º–∞–Ω–∏–µ:</b><br>
            –î–∏–∞–≥–Ω–æ–∑—ã <b>Z34</b> –∏ <b>Z36</b> –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ —Ñ–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–º—É —Ç–µ—á–µ–Ω–∏—é –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏.<br><br>
            üí° <b>–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:</b><br>
            –ù–∞–∑–Ω–∞—á–∞—Ç—å —É—Å–ª—É–≥–∏ –ø–æ –Ω–∏–º —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö –ø–ª–∞–Ω–æ–≤—ã—Ö —è–≤–æ–∫. –ü—Ä–∏ –æ—Å–ª–æ–∂–Ω–µ–Ω–∏—è—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–¥—ã: <b>Z35</b>, <b>O10‚ÄìO16</b>, <b>O20‚ÄìO29</b>.
          </div>`;
        }

        resultDiv.innerHTML = html;

      }).–ø–æ–ª—É—á–∏—Ç—å–ü–æ–¥—Å–∫–∞–∑–∫—É(–∫–æ–¥);
    }
  </script>
</body>
</html>
